var l=({init:n,routes:t,plugins:e,runtime:o})=>{let s=()=>{};n=typeof n=="function"?n:s,e=(e instanceof Array?e:[]).filter(a=>typeof a=="function");var u=s;let r=n()||{};var m=!0;let P=o(a=>{if(!m)return;let g=a.split("?"),w=g.shift(),b=w.split("/").map(decodeURIComponent),U=g.join("?"),{route:R,Params:j}=Object.keys(t).reduce((c,v)=>{let f=v.split("/");if(f.length==b.length){var h=1;let x=b.reduce((i,y,p)=>(i&&(f[p].substr(0,1)==":"?i[f[p].substr(1)]=y:f[p]!==y?i=null:h++),i),{});if(x&&h>c.weight)return{route:v,Params:x,weight:h}}return c},{route:"*",Params:{},weight:0}),q=t[R];typeof q=="function"&&(r.url=a,r.route=R,r.path=w,r.Params=j,r.query=U,e.forEach(c=>c(r)),u(r),u=q(r)||s)})||s;return()=>{m=!1,u(r),P(r)}};var d=n=>{n.Query=n.query.split("&").map(t=>t.split("=")).map(t=>({key:decodeURIComponent(t.shift()),value:decodeURIComponent(t.join("="))})).filter(({key:t})=>t!="").reduce((t,{key:e,value:o})=>(e.substr(e.length-2)=="[]"?(e=e.substr(0,e.length-2),t[e]instanceof Array||(t[e]=[]),t[e].push(o)):t[e]=o,t),{})};var C=({plugins:n,...t})=>l({...t,plugins:[d].concat(n),runtime:e=>{let o=()=>{console.log("hashchange"),e((window.location.hash||"#/").substr(1))};return window.addEventListener("hashchange",o),o(),()=>{window.removeEventListener("hashchange",o)}}});export{C as hashRouter,d as queryParser,l as wand};
